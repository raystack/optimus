app:
  labels:
    environment: dev

image:
  repository: odpf/optimus
  tag: "0.4.1"
  pullPolicy: IfNotPresent

container:
  command:
    - optimus
  args:
    - serve
    - --install-plugins
    - -c
    - /etc/optimus/config.yaml  # mounted as per helm chart
  volumeMounts:
    - mountPath: /airflow-dags/dags
      name: dags-path
    - mountPath: /app/optimus-plugins.tar.gz
      name: internal-plugins
    - mountPath: /app/transformers.tar.gz
      name: odpf-plugins
    

volumes:
  - name: dags-path
    hostPath: 
      path: /tmp/colima/dags
      type: Directory
  - name: internal-plugins
    hostPath: 
      path: /Users/path/to/optimus-plugins/dist/optimus-plugins_0.6.1_linux_amd64.tar.gz
      type: FileOrCreate  # for internal plugins
  - name: odpf-plugins
    hostPath: 
      path: /Users/path/to/transformers/dist/transformers_0.1.1_linux_arm64.tar.gz
      type: File

telegraf:
  enabled: false
ingress:
  enabled: false

configYaml: |-
  version: 1
  log:
    level: DEBUG
  serve:
    port: 9100
    ingress_host: optimus.optimus.svc.cluster.local
  scheduler:
    name: airflow2
  plugin:
    artifacts:
      - https://raw.githubusercontent.com/odpf/transformers/v0.1.7/task/bq2bq/optimus-plugin-bq2bq.yaml
      - /app/optimus-plugins.tar.gz
      - /app/transformers.tar.gz


config:
  OPTIMUS_SERVE_DB_DSN: postgres://optimus:optimus@database-service/optimus?sslmode=disable
  OPTIMUS_SERVE_APP_KEY: hgfhjsdfhsdhjsdfgjhfhdf
